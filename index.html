<!--
Multi-Modal AI Prompt Crafter v1.0
Copyright ¬© 2025 Dradis Holdings LLC
All rights reserved.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quill (Beta) - Evidence-Based Prompt Optimization</title>
    
    <!-- Firebase v9 SDK -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
      import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
      import { getFirestore, doc, setDoc, getDoc, collection, getDocs, deleteDoc } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
      
      // Your Firebase config
      const firebaseConfig = {
        apiKey: "AIzaSyCj2D_emLzgMbVEOBcnAEfSBZdw9ljQ3YE",
        authDomain: "quill-beta1.firebaseapp.com",
        projectId: "quill-beta1",
        storageBucket: "quill-beta1.appspot.com",
        messagingSenderId: "123456789",
        appId: "1:242836015487:web:c5cdd8ac6148e89924b24a"
      };
      
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      const provider = new GoogleAuthProvider();
      
      // Make available globally for use in your existing JavaScript
      window.firebaseAuth = auth;
      window.firebaseDb = db;
      window.firebaseProvider = provider;
      window.firebaseAuthFunctions = {
        signInWithPopup,
        signOut,
        onAuthStateChanged
      };
      window.firestoreFunctions = {
        doc,
        setDoc,
        getDoc,
        collection,
        getDocs,
        deleteDoc
      };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            line-height: 1.6;
            color: #2d3748;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header-main h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header-main p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .auth-section {
            display: flex;
            align-items: center;
        }
        
        .auth-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .sign-in-btn {
            background: white;
            color: #4f46e5;
        }
        
        .sign-in-btn:hover {
            background: #f3f4f6;
            transform: translateY(-1px);
        }
        
        .sign-out-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-size: 0.8rem;
            padding: 6px 12px;
        }
        
        .sign-out-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
        }
        
        .user-actions {
            display: flex;
            gap: 8px;
        }
        
        .data-management-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-size: 0.8rem;
            padding: 6px 12px;
        }
        
        .data-management-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .user-name {
            font-size: 0.9rem;
            font-weight: 600;
            opacity: 0.9;
        }
        
        .form-container {
            padding: 40px;
        }
        
        .template-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #f3f4f6;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .template-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .template-card:hover {
            transform: translateY(-3px);
            border-color: #6366f1;
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.15);
        }
        
        .template-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .template-title {
            font-weight: 600;
            font-size: 1rem;
            color: #374151;
            margin-bottom: 5px;
        }
        
        .template-desc {
            font-size: 0.875rem;
            color: #6b7280;
            line-height: 1.4;
        }
        
        .template-active {
            background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
            border-color: #8b5cf6;
        }
        
        .multi-model {
            position: relative;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
        }
        
        .multi-model:hover {
            border-color: #d97706;
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.2);
        }
        
        .model-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #f59e0b;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 1rem;
        }
        
        .required {
            color: #dc2626;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9fafb;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #6366f1;
            background: white;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .form-group textarea#mainQuery {
            min-height: 120px;
        }
        
        .form-group textarea#context {
            min-height: 240px;
        }
        
        .help-text {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 5px;
            font-style: italic;
        }
        
        .form-feedback {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-top: 8px;
            gap: 15px;
        }
        
        .feedback-container {
            flex-grow: 1;
        }
        
        .feedback-item {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 5px;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .feedback-item.suggestion {
            background: #dbeafe;
            border-color: #3b82f6;
        }
        
        .feedback-item.warning {
            background: #fee2e2;
            border-color: #ef4444;
        }
        
        .feedback-text {
            flex-grow: 1;
        }
        
        .apply-suggestion {
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.7rem;
            cursor: pointer;
            margin-left: 8px;
        }
        
        .apply-suggestion:hover {
            background: #2563eb;
        }
        
        .token-counter {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.8rem;
            color: #374151;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .token-counter.warning {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #92400e;
        }
        
        .token-counter.error {
            background: #fee2e2;
            border-color: #ef4444;
            color: #dc2626;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            flex: 1;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 2px solid #d1d5db;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
            transform: translateY(-1px);
        }
        
        .btn-tertiary {
            background: #e5e7eb;
            color: #374151;
            border: 2px solid #d1d5db;
        }
        
        .btn-tertiary:hover {
            background: #d1d5db;
            transform: translateY(-1px);
        }
        
        .saved-prompts-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }
        
        .saved-prompts-list {
            display: grid;
            gap: 10px;
        }
        
        .saved-prompt-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .saved-prompt-item:hover {
            border-color: #6366f1;
            transform: translateY(-1px);
        }
        
        .saved-prompt-info {
            flex-grow: 1;
        }
        
        .saved-prompt-title {
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }
        
        .saved-prompt-meta {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        .saved-prompt-actions {
            display: flex;
            gap: 8px;
        }
        
        .saved-prompt-actions button {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .load-btn {
            background: #6366f1;
            color: white;
        }
        
        .load-btn:hover {
            background: #5856eb;
        }
        
        .delete-btn {
            background: #ef4444;
            color: white;
        }
        
        .delete-btn:hover {
            background: #dc2626;
        }
        
        .output-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #f3f4f6;
        }
        
        .output-label {
            font-weight: 600;
            margin-bottom: 15px;
            color: #374151;
            font-size: 1.1rem;
        }
        
        .output-box {
            background: #1f2937;
            color: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            white-space: pre-wrap;
            min-height: 200px;
            border: 2px solid #374151;
            position: relative;
            overflow-y: auto;
            max-height: 400px;
        }
        
        .output-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
        }
        
        .copy-btn, .share-btn {
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .copy-btn {
            background: #4f46e5;
            color: white;
        }
        
        .copy-btn:hover {
            background: #4338ca;
            transform: scale(1.05);
        }
        
        .share-btn {
            background: #10b981;
            color: white;
        }
        
        .share-btn:hover {
            background: #059669;
            transform: scale(1.05);
        }
        
        .error-message {
            background: #fef2f2;
            border: 2px solid #fecaca;
            color: #b91c1c;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .footer {
            background: #f8fafc;
            border-top: 2px solid #e5e7eb;
            padding: 30px 40px;
            text-align: center;
            color: #6b7280;
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .footer-links a {
            color: #6366f1;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        
        .footer-links a:hover {
            color: #4f46e5;
            text-decoration: underline;
        }
        
        .copyright {
            font-weight: 500;
        }
        
        .version {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .powered-by {
            color: #9ca3af;
            font-style: italic;
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-bottom: 2px solid #f3f4f6;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #374151;
            font-size: 1.3rem;
        }
        
        .close {
            color: #9ca3af;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        
        .close:hover {
            color: #374151;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .data-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .data-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .data-section h4 {
            color: #374151;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .data-section p {
            color: #6b7280;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .warning-text {
            color: #dc2626 !important;
            font-weight: 500;
        }
        
        .btn-danger {
            background: #dc2626;
            color: white;
        }
        
        .btn-danger:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }
        
        .consent-section ul {
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .consent-section li {
            color: #6b7280;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .consent-checkboxes {
            margin: 25px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }
        
        .checkbox-label {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #374151;
            cursor: pointer;
        }
        
        .checkbox-label:last-child {
            margin-bottom: 0;
        }
        
        .checkbox-label input[type="checkbox"] {
            margin-top: 2px;
            width: auto;
        }
        
        .consent-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-main">
                    <h1>üìù Quill (Beta)</h1>
                    <p>Evidence-Based Prompt Optimization</p>
                </div>
                <div class="auth-section" id="authSection">
                    <button id="signInBtn" class="auth-btn sign-in-btn" onclick="signInWithGoogle()">
                        Sign in with Google
                    </button>
                    <div id="userProfile" class="user-profile" style="display: none;">
                        <img id="userAvatar" class="user-avatar" src="" alt="User">
                        <div class="user-info">
                            <div id="userName" class="user-name"></div>
                            <div class="user-actions">
                                <button id="dataManagementBtn" class="auth-btn data-management-btn" onclick="showDataManagement()">Data</button>
                                <button id="signOutBtn" class="auth-btn sign-out-btn" onclick="signOutUser()">Sign Out</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-container">
            <div class="template-section">
                <h3 style="margin-bottom: 15px; color: #374151; font-size: 1.2rem; font-weight: 600;">üìã Research-Optimized Templates</h3>
                <div class="template-grid">
                    <button type="button" class="template-card" onclick="loadTemplate('product-research')">
                        <div class="template-icon">üõçÔ∏è</div>
                        <div class="template-title">Product Research</div>
                        <div class="template-desc">Research products, compare options, find pricing</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('business-analysis')">
                        <div class="template-icon">üìä</div>
                        <div class="template-title">Business Analysis</div>
                        <div class="template-desc">Market research, competitor analysis, strategy</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('technical-help')">
                        <div class="template-icon">‚öôÔ∏è</div>
                        <div class="template-title">Technical Help</div>
                        <div class="template-desc">Coding, troubleshooting, implementation</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('content-creation')">
                        <div class="template-icon">‚úçÔ∏è</div>
                        <div class="template-title">Content Creation</div>
                        <div class="template-desc">Writing, editing, creative projects</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('learning-research')">
                        <div class="template-icon">üéì</div>
                        <div class="template-title">Learning & Research</div>
                        <div class="template-desc">Academic research, learning new topics</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('decision-making')">
                        <div class="template-icon">ü§î</div>
                        <div class="template-title">Decision Making</div>
                        <div class="template-desc">Evaluate options, pros/cons, recommendations</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('creative-projects')">
                        <div class="template-icon">üé®</div>
                        <div class="template-title">Creative Projects</div>
                        <div class="template-desc">Brainstorming, creative writing, design concepts</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('data-analysis')">
                        <div class="template-icon">üìà</div>
                        <div class="template-title">Data Analysis</div>
                        <div class="template-desc">Interpret data, find insights, create visualizations</div>
                    </button>
                    <button type="button" class="template-card" onclick="loadTemplate('workflow-automation')">
                        <div class="template-icon">üîÑ</div>
                        <div class="template-title">Workflow Automation</div>
                        <div class="template-desc">Process optimization, automation ideas</div>
                    </button>
                    <button type="button" class="template-card multi-model" onclick="loadTemplate('visual-content')">
                        <div class="template-icon">üñºÔ∏è</div>
                        <div class="template-title">Visual Content</div>
                        <div class="template-desc">Image generation, visual design concepts</div>
                        <div class="model-badge">Multi-Model</div>
                    </button>
                    <button type="button" class="template-card multi-model" onclick="loadTemplate('video-audio')">
                        <div class="template-icon">üé¨</div>
                        <div class="template-title">Video & Audio</div>
                        <div class="template-desc">Video creation, audio generation, multimedia</div>
                        <div class="model-badge">Multi-Model</div>
                    </button>
                    <button type="button" class="template-card multi-model" onclick="loadTemplate('code-generation')">
                        <div class="template-icon">üíª</div>
                        <div class="template-title">Advanced Coding</div>
                        <div class="template-desc">Complex development, specialized languages</div>
                        <div class="model-badge">Multi-Model</div>
                    </button>
                </div>
            </div>
            
            <form id="promptForm">
                <div class="form-group">
                    <label for="aiModel">AI Model Selection</label>
                    <select id="aiModel" name="aiModel">
                        <option value="claude">Claude (Text, Analysis, Research)</option>
                        <option value="multimodel">Multi-Model Workflow (Advanced)</option>
                    </select>
                    <div class="help-text">Choose the AI approach for your task</div>
                </div>

                <div class="form-group" id="modelWorkflowGroup" style="display: none;">
                    <label for="modelWorkflow">Model Workflow</label>
                    <textarea id="modelWorkflow" name="modelWorkflow" placeholder="Describe the multi-model workflow needed:
- Claude: Research and planning
- DALL-E/Midjourney: Image generation  
- RunwayML: Video creation
- Custom models: Specialized tasks"></textarea>
                    <div class="help-text">Describe which models should be used and how they work together</div>
                </div>

                <div class="form-group">
                    <label for="role">Primary Role Assignment <span class="required">*</span></label>
                    <select id="role" name="role" required>
                        <option value="">Select a role...</option>
                        <option value="research assistant">Research Assistant</option>
                        <option value="technical advisor">Technical Advisor</option>
                        <option value="technical research consultant">Technical Research Consultant</option>
                        <option value="writing partner">Writing Partner</option>
                        <option value="analyst">Data Analyst</option>
                        <option value="consultant">Strategy Consultant</option>
                        <option value="tutor">Educational Tutor</option>
                        <option value="custom">Custom Role</option>
                    </select>
                    <div class="help-text">What specific role should the AI assume for this task?</div>
                </div>

                <div class="form-group" id="customRoleGroup" style="display: none;">
                    <label for="customRole">Custom Role Description</label>
                    <input type="text" id="customRole" name="customRole" placeholder="e.g., UX Design Critic, Financial Planner, Project Manager, etc.">
                </div>

                <div class="form-group">
                    <label for="audience">Target Audience</label>
                    <select id="audience" name="audience">
                        <option value="">Select audience...</option>
                        <option value="expert">Expert in the field</option>
                        <option value="professional">Working professional</option>
                        <option value="student">Student/learner</option>
                        <option value="general">General audience</option>
                        <option value="executive">Executive/decision-maker</option>
                        <option value="technical">Technical specialist</option>
                        <option value="custom">Custom audience</option>
                    </select>
                    <div class="help-text">Who will be reading or using the AI's response?</div>
                </div>

                <div class="form-group" id="customAudienceGroup" style="display: none;">
                    <label for="customAudience">Custom Audience Description</label>
                    <input type="text" id="customAudience" name="customAudience" placeholder="Describe the specific audience...">
                </div>

                <div class="form-group">
                    <label for="mainQuery">Your Main Question/Request <span class="required">*</span></label>
                    <textarea id="mainQuery" name="mainQuery" placeholder="What specifically do you want Claude to help you with?" required></textarea>
                    <div class="help-text">Be as specific as possible about what you need</div>
                </div>
                
                <div class="form-group">
                    <label for="context">Context & Background</label>
                    <textarea id="context" name="context" placeholder="Provide relevant background information, your situation, constraints, etc.

Example structure:
- Current situation: [describe your setup/problem]
- What you've tried: [previous solutions/approaches]
- Constraints: [budget, timeline, technical limitations]
- Goals: [what success looks like]"></textarea>
                    <div class="help-text">What does Claude need to know about your situation?</div>
                </div>
                
                <div class="form-group">
                    <label for="stakes">Stakes & Importance</label>
                    <select id="stakes" name="stakes">
                        <option value="">Select importance level...</option>
                        <option value="high">High - Making important decisions based on this</option>
                        <option value="medium" selected>Medium - Need reliable information</option>
                        <option value="low">Low - General exploration/learning</option>
                        <option value="custom">Custom</option>
                    </select>
                    <div class="help-text">How critical is accuracy for your use case?</div>
                </div>

                <div class="form-group" id="customStakesGroup" style="display: none;">
                    <label for="customStakes">Custom Stakes Description</label>
                    <textarea id="customStakes" name="customStakes" placeholder="Describe why accuracy/quality matters for your specific situation..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="outputType">Desired Output Type</label>
                    <select id="outputType" name="outputType">
                        <option value="">Select output format...</option>
                        <option value="recommendations">Specific Recommendations</option>
                        <option value="analysis">Detailed Analysis</option>
                        <option value="comparison">Comparison/Evaluation</option>
                        <option value="stepbystep">Step-by-Step Guide</option>
                        <option value="summary">Summary/Overview</option>
                        <option value="list">Organized List</option>
                        <option value="custom">Custom Format</option>
                    </select>
                    <div class="help-text">What format would be most useful?</div>
                </div>

                <div class="form-group" id="customOutputGroup" style="display: none;">
                    <label for="customOutput">Custom Output Description</label>
                    <input type="text" id="customOutput" name="customOutput" placeholder="Describe the specific format you need...">
                </div>
                
                <div class="form-group">
                    <label for="researchNeeds">Research & Information Needs</label>
                    <select id="researchNeeds" name="researchNeeds">
                        <option value="">Select research requirements...</option>
                        <option value="current">Search for current/recent information</option>
                        <option value="products">Research specific products, pricing, and availability</option>
                        <option value="comprehensive">Comprehensive research with multiple sources</option>
                        <option value="comparison">Compare multiple options/products/services</option>
                        <option value="verify">Verify claims and check real-time data</option>
                        <option value="trends">Research current trends and developments</option>
                        <option value="local">Include location-specific information</option>
                        <option value="custom">Custom research needs</option>
                    </select>
                    <div class="help-text">What type of web research should Claude perform?</div>
                </div>

                <div class="form-group" id="customResearchGroup" style="display: none;">
                    <label for="customResearch">Custom Research Requirements</label>
                    <textarea id="customResearch" name="customResearch" placeholder="Describe specific research needs, sources to check, or information to gather..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="verification">Accuracy & Citation Level</label>
                    <select id="verification" name="verification">
                        <option value="">Select verification level...</option>
                        <option value="sources">Include sources and citations for key claims</option>
                        <option value="doublecheck">Cross-reference critical details across sources</option>
                        <option value="current">Prioritize most recent information available</option>
                        <option value="standard">Standard fact-checking approach</option>
                        <option value="custom">Custom verification needs</option>
                    </select>
                    <div class="help-text">How should Claude handle sources and accuracy?</div>
                </div>

                <div class="form-group" id="customVerificationGroup" style="display: none;">
                    <label for="customVerification">Custom Verification Requirements</label>
                    <textarea id="customVerification" name="customVerification" placeholder="Describe specific verification or quality requirements..."></textarea>
                </div>
                
                <div class="button-group">
                    <button type="button" class="btn btn-primary" onclick="generatePrompt()">Generate Prompt</button>
                    <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                    <button type="button" class="btn btn-tertiary" onclick="savePrompt()">Save Prompt</button>
                </div>
            </form>
            
            <div class="saved-prompts-section" id="savedPromptsSection">
                <h3 style="margin-bottom: 15px; color: #374151; font-size: 1.1rem; font-weight: 600;">üíæ Saved Prompts</h3>
                <div id="savedPromptsList" class="saved-prompts-list"></div>
            </div>
            
            <div class="output-section" id="outputSection" style="display: none;">
                <div class="output-label">üìã Generated Prompt (Copy & Paste to Claude)</div>
                <div class="output-box" id="outputBox">
                    <div class="output-actions">
                        <button class="copy-btn" onclick="copyToClipboard()">Copy</button>
                        <button class="share-btn" onclick="sharePrompt()">Share</button>
                    </div>
                    <div id="promptOutput"></div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-content">
                <div class="footer-links">
                    <div class="copyright">¬© 2025 Dradis Holdings LLC</div>
                    <a href="#" onclick="showAbout(); return false;">About</a>
                </div>
                <div class="version">v1.1 Beta</div>
                <div class="powered-by">Evidence-Based Optimization</div>
            </div>
        </div>
    </div>
    
    <!-- Data Management Modal -->
    <div id="dataManagementModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Your Data Management</h3>
                <span class="close" onclick="closeDataManagement()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="data-section">
                    <h4>Export Your Data</h4>
                    <p>Download all your saved prompts and account data in JSON format.</p>
                    <button class="btn btn-secondary" onclick="exportUserData()">Download My Data</button>
                </div>
                
                <div class="data-section">
                    <h4>Delete Account</h4>
                    <p class="warning-text">This will permanently delete your account and all saved prompts. This action cannot be undone.</p>
                    <button class="btn btn-danger" onclick="confirmDeleteAccount()">Delete My Account</button>
                </div>
                
                <div class="data-section">
                    <h4>Privacy Information</h4>
                    <p>We store your Google account information (name, email, profile picture) and your saved prompts. All data is encrypted and stored securely. You can export or delete your data at any time.</p>
                    <p><strong>Data Processing Legal Basis:</strong> Legitimate interest for providing cloud sync functionality.</p>
                    <p><strong>Data Retention:</strong> Until you delete your account or request data deletion.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Consent Modal -->
    <div id="privacyConsentModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Privacy & Data Consent</h3>
            </div>
            <div class="modal-body">
                <div class="consent-section">
                    <h4>Data We Collect</h4>
                    <ul>
                        <li>Google account information (name, email, profile picture)</li>
                        <li>Your saved prompts and preferences</li>
                        <li>Usage analytics (anonymous)</li>
                    </ul>
                    
                    <h4>How We Use Your Data</h4>
                    <ul>
                        <li>Provide cloud sync for your saved prompts</li>
                        <li>Authenticate your account across devices</li>
                        <li>Improve our service through anonymous usage analytics</li>
                    </ul>
                    
                    <h4>Your Rights</h4>
                    <ul>
                        <li>Export all your data at any time</li>
                        <li>Delete your account and all data</li>
                        <li>Withdraw consent (which will delete your account)</li>
                    </ul>
                    
                    <div class="consent-checkboxes">
                        <label class="checkbox-label">
                            <input type="checkbox" id="consentRequired" required>
                            I consent to the collection and processing of my data as described above (Required)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="consentAnalytics">
                            I consent to anonymous usage analytics to help improve the service (Optional)
                        </label>
                    </div>
                    
                    <div class="consent-actions">
                        <button class="btn btn-primary" onclick="acceptConsent()">Accept & Continue</button>
                        <button class="btn btn-secondary" onclick="declineConsent()">Decline</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /*
        Multi-Modal AI Prompt Crafter v1.0
        Copyright ¬© 2025 Dradis Holdings LLC
        All rights reserved.
        */
        
        // Firebase Authentication Functions
        let currentUser = null;
        
        function signInWithGoogle() {
            const { signInWithPopup } = window.firebaseAuthFunctions;
            
            signInWithPopup(window.firebaseAuth, window.firebaseProvider)
                .then((result) => {
                    currentUser = result.user;
                    updateAuthUI();
                    syncUserData();
                    console.log('User signed in:', currentUser.displayName);
                })
                .catch((error) => {
                    console.error('Sign-in error:', error);
                    alert('Sign-in failed. Please try again.');
                });
        }
        
        function signOutUser() {
            const { signOut } = window.firebaseAuthFunctions;
            
            signOut(window.firebaseAuth)
                .then(() => {
                    currentUser = null;
                    updateAuthUI();
                    console.log('User signed out');
                })
                .catch((error) => {
                    console.error('Sign-out error:', error);
                });
        }
        
        function updateAuthUI() {
            const signInBtn = document.getElementById('signInBtn');
            const userProfile = document.getElementById('userProfile');
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            
            if (currentUser) {
                signInBtn.style.display = 'none';
                userProfile.style.display = 'flex';
                userAvatar.src = currentUser.photoURL || '';
                userName.textContent = currentUser.displayName || currentUser.email;
            } else {
                signInBtn.style.display = 'block';
                userProfile.style.display = 'none';
            }
        }
        
        function syncUserData() {
            if (!currentUser) return;
            
            // Load user's saved prompts from Firestore
            loadUserPrompts();
        }
        
        async function loadUserPrompts() {
            if (!currentUser) return;
            
            try {
                const { collection, getDocs } = window.firestoreFunctions;
                const userPromptsRef = collection(window.firebaseDb, 'users', currentUser.uid, 'savedPrompts');
                const querySnapshot = await getDocs(userPromptsRef);
                
                const cloudPrompts = [];
                querySnapshot.forEach((doc) => {
                    cloudPrompts.push({ id: doc.id, ...doc.data() });
                });
                
                // Merge with local prompts and update display
                mergePrompts(cloudPrompts);
                
            } catch (error) {
                console.error('Error loading user prompts:', error);
            }
        }
        
        function mergePrompts(cloudPrompts) {
            const localPrompts = getSavedPrompts();
            
            // Simple merge strategy: cloud prompts take precedence
            const mergedPrompts = [...cloudPrompts];
            
            // Add local prompts that don't exist in cloud
            localPrompts.forEach(localPrompt => {
                if (!cloudPrompts.find(cloudPrompt => cloudPrompt.id === localPrompt.id)) {
                    mergedPrompts.push(localPrompt);
                }
            });
            
            // Update local storage and display
            localStorage.setItem('promptCrafterSaved', JSON.stringify(mergedPrompts));
            displaySavedPrompts();
        }
        
        // Prompt Optimization Functions (Research-Based)
        
        // Affirmative Language Detection
        function checkAffirmativeLanguage(element, feedbackId) {
            const text = element.value.toLowerCase();
            const feedbackContainer = document.getElementById(feedbackId);
            
            const negativePatterns = [
                { pattern: /\b(don't|do not)\s+be\s+verbose\b/gi, suggestion: "be concise and direct" },
                { pattern: /\b(avoid|don't use)\s+jargon\b/gi, suggestion: "use clear, simple terminology" },
                { pattern: /\b(don't|avoid)\s+complic/gi, suggestion: "keep it simple" },
                { pattern: /\b(never|don't)\s+assum/gi, suggestion: "consider all perspectives" },
                { pattern: /\b(avoid|don't)\s+being\s+bias/gi, suggestion: "maintain objectivity" },
                { pattern: /\b(don't|avoid)\s+mak/gi, suggestion: "ensure accuracy" },
                { pattern: /\bcan't\b/gi, suggestion: "unable to" },
                { pattern: /\bwon't\b/gi, suggestion: "will not" }
            ];
            
            let suggestions = [];
            negativePatterns.forEach(item => {
                if (item.pattern.test(text)) {
                    const match = text.match(item.pattern);
                    if (match) {
                        suggestions.push({
                            original: match[0],
                            suggestion: item.suggestion,
                            type: 'affirmative'
                        });
                    }
                }
            });
            
            displayFeedback(feedbackContainer, suggestions, element);
        }
        
        // Token Counter with Efficiency Warnings
        function updateTokenCount(element, counterId) {
            const text = element.value;
            const tokenCount = estimateTokens(text);
            const counter = document.getElementById(counterId);
            
            counter.textContent = `Tokens: ${tokenCount}`;
            counter.className = 'token-counter';
            
            if (tokenCount > 500) {
                counter.className += ' error';
                counter.textContent += ' (Too long - consider shortening)';
            } else if (tokenCount > 300) {
                counter.className += ' warning';
                counter.textContent += ' (Getting long)';
            }
        }
        
        // Simple token estimation (roughly 4 characters per token)
        function estimateTokens(text) {
            return Math.ceil(text.length / 4);
        }
        
        // Display feedback with suggestions
        function displayFeedback(container, suggestions, element) {
            container.innerHTML = '';
            
            suggestions.forEach(item => {
                const feedbackItem = document.createElement('div');
                feedbackItem.className = 'feedback-item suggestion';
                
                const feedbackText = document.createElement('span');
                feedbackText.className = 'feedback-text';
                feedbackText.textContent = `Consider: "${item.suggestion}" instead of "${item.original}"`;
                
                const applyBtn = document.createElement('button');
                applyBtn.className = 'apply-suggestion';
                applyBtn.textContent = 'Apply';
                applyBtn.type = 'button';
                applyBtn.onclick = () => {
                    const currentText = element.value;
                    const newText = currentText.replace(new RegExp(item.original, 'gi'), item.suggestion);
                    element.value = newText;
                    checkAffirmativeLanguage(element, container.id);
                    updateTokenCount(element, element.id + 'TokenCount');
                };
                
                feedbackItem.appendChild(feedbackText);
                feedbackItem.appendChild(applyBtn);
                container.appendChild(feedbackItem);
            });
        }
        window.addEventListener('DOMContentLoaded', function() {
            const { onAuthStateChanged } = window.firebaseAuthFunctions;
            
            onAuthStateChanged(window.firebaseAuth, (user) => {
                currentUser = user;
                updateAuthUI();
                if (user) {
                    checkUserConsent();
                    syncUserData();
                }
            });
            
            displaySavedPrompts();
            loadSharedPrompt();
        });
        
        // Data Management Functions
        function showDataManagement() {
            document.getElementById('dataManagementModal').style.display = 'block';
        }
        
        function closeDataManagement() {
            document.getElementById('dataManagementModal').style.display = 'none';
        }
        
        async function exportUserData() {
            if (!currentUser) return;
            
            try {
                // Collect all user data
                const userData = {
                    user: {
                        uid: currentUser.uid,
                        name: currentUser.displayName,
                        email: currentUser.email,
                        exportDate: new Date().toISOString()
                    },
                    savedPrompts: getSavedPrompts(),
                    analytics: getAnalytics()
                };
                
                // Create and download file
                const dataStr = JSON.stringify(userData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `prompt-crafter-data-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                URL.revokeObjectURL(url);
                alert('Your data has been downloaded successfully.');
                
            } catch (error) {
                console.error('Error exporting data:', error);
                alert('Error exporting data. Please try again.');
            }
        }
        
        function confirmDeleteAccount() {
            const confirmation = prompt('Type "DELETE" to confirm permanent account deletion:');
            if (confirmation === 'DELETE') {
                deleteUserAccount();
            } else {
                alert('Account deletion cancelled.');
            }
        }
        
        async function deleteUserAccount() {
            if (!currentUser) return;
            
            try {
                // Delete user data from Firestore
                const { collection, getDocs, deleteDoc, doc } = window.firestoreFunctions;
                const userPromptsRef = collection(window.firebaseDb, 'users', currentUser.uid, 'savedPrompts');
                const querySnapshot = await getDocs(userPromptsRef);
                
                // Delete all saved prompts
                const deletePromises = [];
                querySnapshot.forEach((promptDoc) => {
                    deletePromises.push(deleteDoc(promptDoc.ref));
                });
                await Promise.all(deletePromises);
                
                // Delete user document
                const userDocRef = doc(window.firebaseDb, 'users', currentUser.uid);
                await deleteDoc(userDocRef);
                
                // Clear local storage
                localStorage.removeItem('promptCrafterSaved');
                localStorage.removeItem('promptCrafterAnalytics');
                localStorage.removeItem('promptCrafterConsent');
                
                // Sign out user
                await signOutUser();
                
                alert('Your account and all data have been permanently deleted.');
                closeDataManagement();
                
            } catch (error) {
                console.error('Error deleting account:', error);
                alert('Error deleting account. Please contact support.');
            }
        }
        
        // Privacy Consent Functions
        function checkUserConsent() {
            const consent = localStorage.getItem('promptCrafterConsent');
            if (!consent && currentUser) {
                setTimeout(() => {
                    document.getElementById('privacyConsentModal').style.display = 'block';
                }, 1000);
            }
        }
        
        function acceptConsent() {
            const requiredConsent = document.getElementById('consentRequired').checked;
            const analyticsConsent = document.getElementById('consentAnalytics').checked;
            
            if (!requiredConsent) {
                alert('Required consent must be given to use the service.');
                return;
            }
            
            const consentData = {
                required: true,
                analytics: analyticsConsent,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent
            };
            
            localStorage.setItem('promptCrafterConsent', JSON.stringify(consentData));
            document.getElementById('privacyConsentModal').style.display = 'none';
        }
        
        function declineConsent() {
            alert('Without consent, we cannot provide cloud sync services. You will be signed out.');
            signOutUser();
            document.getElementById('privacyConsentModal').style.display = 'none';
        }
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            const dataModal = document.getElementById('dataManagementModal');
            const consentModal = document.getElementById('privacyConsentModal');
            
            if (event.target === dataModal) {
                closeDataManagement();
            }
            if (event.target === consentModal) {
                // Don't allow closing consent modal by clicking outside
            }
        }
        
        const templates = {
            'product-research': {
                role: 'research assistant',
                aiModel: 'claude',
                mainQuery: 'Help me research and compare [product category] options that fit my needs and budget.',
                context: 'I\'m looking for products in a specific category and need help finding the best options.\n\n‚Ä¢ Budget: [Your budget range]\n‚Ä¢ Must-have features: [Essential requirements]\n‚Ä¢ Nice-to-have features: [Preferred but not required]\n‚Ä¢ Use case: [How you\'ll use it]\n‚Ä¢ Timeline: [When you need to purchase]',
                stakes: 'high',
                outputType: 'comparison',
                researchNeeds: 'products',
                verification: 'sources'
            },
            'business-analysis': {
                role: 'consultant',
                aiModel: 'claude',
                mainQuery: 'Provide strategic analysis and recommendations for [specific business challenge or opportunity].',
                context: 'I need strategic business insights for decision-making.\n\n‚Ä¢ Company/industry: [Your business context]\n‚Ä¢ Current situation: [What\'s happening now]\n‚Ä¢ Goals: [What you want to achieve]\n‚Ä¢ Constraints: [Budget, timeline, resources]\n‚Ä¢ Stakeholders: [Who\'s involved in the decision]',
                stakes: 'high',
                outputType: 'analysis',
                researchNeeds: 'comprehensive',
                verification: 'sources'
            },
            'technical-help': {
                role: 'technical advisor',
                aiModel: 'claude',
                mainQuery: 'Help me solve [specific technical problem] with practical, implementable solutions.',
                context: 'I need technical assistance with a specific implementation.\n\n‚Ä¢ Tech stack: [Languages, frameworks, tools you\'re using]\n‚Ä¢ Current setup: [What you have now]\n‚Ä¢ Problem: [What\'s not working or what you need to build]\n‚Ä¢ Constraints: [Technical limitations, requirements]\n‚Ä¢ Experience level: [Your technical background]',
                stakes: 'medium',
                outputType: 'stepbystep',
                researchNeeds: 'current',
                verification: 'doublecheck'
            },
            'content-creation': {
                role: 'writing partner',
                aiModel: 'claude',
                mainQuery: 'Help me create [type of content] that effectively communicates [key message] to [target audience].',
                context: 'I need help creating content for a specific purpose.\n\n‚Ä¢ Content type: [Blog post, email, proposal, etc.]\n‚Ä¢ Audience: [Who will read this]\n‚Ä¢ Tone/style: [Professional, casual, persuasive, etc.]\n‚Ä¢ Key messages: [Main points to communicate]\n‚Ä¢ Constraints: [Length, format, deadlines]',
                stakes: 'medium',
                outputType: 'recommendations',
                researchNeeds: 'trends',
                verification: 'standard'
            },
            'learning-research': {
                role: 'tutor',
                aiModel: 'claude',
                mainQuery: 'Create a learning plan and explain [topic] in a way that builds on my current knowledge.',
                context: 'I\'m learning about a new topic and need structured guidance.\n\n‚Ä¢ Current knowledge: [What you already know]\n‚Ä¢ Learning goals: [What you want to understand]\n‚Ä¢ Learning style: [How you prefer to learn]\n‚Ä¢ Timeline: [How quickly you need to learn]\n‚Ä¢ Application: [How you\'ll use this knowledge]',
                stakes: 'low',
                outputType: 'stepbystep',
                researchNeeds: 'comprehensive',
                verification: 'sources'
            },
            'decision-making': {
                role: 'consultant',
                aiModel: 'claude',
                mainQuery: 'Help me evaluate my options and make an informed decision about [specific decision].',
                context: 'I need to make an important decision and want objective analysis.\n\n‚Ä¢ Decision: [What you need to decide]\n‚Ä¢ Options: [The choices you\'re considering]\n‚Ä¢ Criteria: [What matters most in this decision]\n‚Ä¢ Timeline: [When you need to decide]\n‚Ä¢ Impact: [Who/what will be affected]',
                stakes: 'high',
                outputType: 'comparison',
                researchNeeds: 'verify',
                verification: 'doublecheck'
            },
            'creative-projects': {
                role: 'writing partner',
                aiModel: 'claude',
                mainQuery: 'Help me develop creative concepts and content for [specific creative project].',
                context: 'I need creative assistance for an artistic or imaginative project.\n\n‚Ä¢ Project type: [Story, campaign, concept, etc.]\n‚Ä¢ Style/genre: [Tone, aesthetic, influences]\n‚Ä¢ Audience: [Who this is for]\n‚Ä¢ Constraints: [Length, format, content guidelines]\n‚Ä¢ Inspiration: [Existing works, themes, ideas you like]',
                stakes: 'medium',
                outputType: 'recommendations',
                researchNeeds: 'trends',
                verification: 'standard'
            },
            'data-analysis': {
                role: 'analyst',
                aiModel: 'claude',
                mainQuery: 'Analyze my data and provide actionable insights about [specific analytical question].',
                context: 'I need help analyzing data to extract meaningful insights.\n\n‚Ä¢ Data type: [Sales, survey, performance, etc.]\n‚Ä¢ Data size: [Amount and complexity]\n‚Ä¢ Key questions: [What you want to learn]\n‚Ä¢ Visualization needs: [Charts, graphs, dashboards]\n‚Ä¢ Audience: [Who will see the results]',
                stakes: 'high',
                outputType: 'analysis',
                researchNeeds: 'verify',
                verification: 'doublecheck'
            },
            'workflow-automation': {
                role: 'technical advisor',
                aiModel: 'claude',
                mainQuery: 'Design an automation strategy for [specific process or workflow].',
                context: 'I want to automate or optimize a business process.\n\n‚Ä¢ Current process: [How things work now]\n‚Ä¢ Pain points: [What\'s slow, error-prone, or manual]\n‚Ä¢ Tools available: [Software, systems you use]\n‚Ä¢ Constraints: [Budget, technical limitations]\n‚Ä¢ Success metrics: [How you\'ll measure improvement]',
                stakes: 'medium',
                outputType: 'stepbystep',
                researchNeeds: 'current',
                verification: 'sources'
            },
            'visual-content': {
                role: 'consultant',
                aiModel: 'multimodel',
                mainQuery: 'Create a comprehensive visual content strategy and generate images for [specific visual project].',
                context: 'I need to create visual content that combines research, planning, and image generation.\n\n‚Ä¢ Visual goal: [What you want to create]\n‚Ä¢ Brand/style: [Visual identity, aesthetic preferences]\n‚Ä¢ Use case: [Marketing, presentation, personal]\n‚Ä¢ Technical specs: [Size, format, resolution needs]\n‚Ä¢ Content requirements: [Text, elements to include]',
                stakes: 'medium',
                outputType: 'stepbystep',
                researchNeeds: 'trends',
                verification: 'standard',
                modelWorkflow: '‚Ä¢ Claude: Research visual trends, plan composition and messaging\n‚Ä¢ DALL-E/Midjourney: Generate initial visual concepts\n‚Ä¢ Claude: Refine and iterate based on results\n‚Ä¢ Specialized tools: Final editing and optimization'
            },
            'video-audio': {
                role: 'consultant',
                aiModel: 'multimodel',
                mainQuery: 'Plan and coordinate the creation of [specific video/audio content].',
                context: 'I need to create video or audio content with multiple AI tools.\n\n‚Ä¢ Content type: [Explainer, marketing, educational, etc.]\n‚Ä¢ Duration: [Target length]\n‚Ä¢ Audience: [Who will watch/listen]\n‚Ä¢ Style: [Tone, pacing, visual style]\n‚Ä¢ Distribution: [Where it will be shared]',
                stakes: 'high',
                outputType: 'stepbystep',
                researchNeeds: 'current',
                verification: 'sources',
                modelWorkflow: '‚Ä¢ Claude: Script writing, storyboard planning, research\n‚Ä¢ DALL-E: Visual assets and thumbnails\n‚Ä¢ RunwayML/Pika: Video generation\n‚Ä¢ ElevenLabs: Voiceover generation\n‚Ä¢ Claude: Quality review and optimization suggestions'
            },
            'code-generation': {
                role: 'technical advisor',
                aiModel: 'multimodel',
                mainQuery: 'Design and implement [specific software project] using best practices and optimal architecture.',
                context: 'I need advanced coding assistance that may require specialized models.\n\n‚Ä¢ Project scope: [What you\'re building]\n‚Ä¢ Technologies: [Languages, frameworks, tools]\n‚Ä¢ Complexity: [Architecture, integrations needed]\n‚Ä¢ Performance needs: [Speed, scale, optimization]\n‚Ä¢ Deployment: [Where and how it will run]',
                stakes: 'high',
                outputType: 'stepbystep',
                researchNeeds: 'current',
                verification: 'doublecheck',
                modelWorkflow: '‚Ä¢ Claude: Architecture planning, code review, documentation\n‚Ä¢ Codex/Specialized models: Complex algorithm generation\n‚Ä¢ Claude: Integration, testing, and optimization\n‚Ä¢ Security models: Vulnerability analysis'
            }
        };

        document.getElementById('aiModel').addEventListener('change', function() {
            const workflowGroup = document.getElementById('modelWorkflowGroup');
            workflowGroup.style.display = this.value === 'multimodel' ? 'block' : 'none';
        });

        document.getElementById('role').addEventListener('change', function() {
            const customGroup = document.getElementById('customRoleGroup');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        document.getElementById('stakes').addEventListener('change', function() {
            const customGroup = document.getElementById('customStakesGroup');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        document.getElementById('outputType').addEventListener('change', function() {
            const customGroup = document.getElementById('customOutputGroup');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        document.getElementById('researchNeeds').addEventListener('change', function() {
            const customGroup = document.getElementById('customResearchGroup');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        document.getElementById('audience').addEventListener('change', function() {
            const customGroup = document.getElementById('customAudienceGroup');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });
        
        document.getElementById('mainQuery').addEventListener('input', function() {
            checkAffirmativeLanguage(this, 'queryFeedback');
            updateTokenCount(this, 'queryTokenCount');
        });

        function generatePrompt() {
            const existingError = document.querySelector('.error-message');
            if (existingError) {
                existingError.remove();
            }

            const form = document.getElementById('promptForm');
            const formData = new FormData(form);
            
            const role = formData.get('role') === 'custom' ? formData.get('customRole') : formData.get('role');
            const mainQuery = formData.get('mainQuery');
            
            if (!role || !mainQuery) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = 'Please fill in the required fields: Role and Main Question/Request.';
                form.insertBefore(errorDiv, form.firstChild);
                return;
            }
            
            const context = formData.get('context');
            const audience = formData.get('audience') === 'custom' ? formData.get('customAudience') : getAudienceText(formData.get('audience'));
            const stakes = formData.get('stakes') === 'custom' ? formData.get('customStakes') : getStakesText(formData.get('stakes'));
            const outputType = formData.get('outputType') === 'custom' ? formData.get('customOutput') : getOutputText(formData.get('outputType'));
            const researchNeeds = formData.get('researchNeeds') === 'custom' ? formData.get('customResearch') : getResearchText(formData.get('researchNeeds'));
            const verification = formData.get('verification') === 'custom' ? formData.get('customVerification') : getVerificationText(formData.get('verification'));
            const aiModel = formData.get('aiModel');
            const modelWorkflow = formData.get('modelWorkflow');
            
            let prompt = '';
            
            if (aiModel === 'multimodel') {
                prompt += '###MULTI-MODEL AI WORKFLOW REQUEST###\n\n';
                prompt += '###PRIMARY COORDINATOR###\nI need you to act as a ' + role + ' and coordinate this multi-model workflow.\n\n';
                prompt += '###TASK###\n' + mainQuery + '\n\n';
                
                if (context) {
                    prompt += '###CONTEXT###\n' + context + '\n\n';
                }
                
                if (modelWorkflow) {
                    prompt += '###WORKFLOW ARCHITECTURE###\n' + modelWorkflow + '\n\n';
                }
                
                prompt += '###YOUR ROLE###\nPlan and coordinate the workflow, provide detailed prompts for each specialized model, and integrate the results into a cohesive final output.\n\n';
            } else {
                prompt += '###ROLE ASSIGNMENT###\n';
                prompt += 'I need you to act as a ' + role + ' for this request.\n\n';
                
                prompt += '###TASK###\n' + mainQuery + '\n\n';
                
                if (context) {
                    prompt += '###CONTEXT###\n' + context + '\n\n';
                }
            }
            
            // Add audience specification if provided
            if (audience) {
                prompt += '###AUDIENCE###\n';
                prompt += 'The audience is ' + audience + '. Tailor your response appropriately.\n\n';
            }
            
            const requirements = [];
            
            if (stakes) {
                requirements.push('‚Ä¢ IMPORTANCE: ' + stakes);
            }
            
            if (outputType) {
                requirements.push('‚Ä¢ DESIRED OUTPUT: ' + outputType);
            }
            
            if (researchNeeds) {
                requirements.push('‚Ä¢ RESEARCH APPROACH: ' + researchNeeds);
            }
            
            if (verification) {
                requirements.push('‚Ä¢ ACCURACY & SOURCES: ' + verification);
            }
            
            if (requirements.length > 0) {
                prompt += '###REQUIREMENTS###\n' + requirements.join('\n') + '\n\n';
            }
            
            prompt += '###SUCCESS CRITERIA###\n';
            prompt += 'Please ask any necessary follow-up questions to focus your research and ensure you provide the most useful results for the specific situation described above.';
            
            document.getElementById('promptOutput').textContent = prompt;
            document.getElementById('outputSection').style.display = 'block';
            
            trackPromptGeneration({
                role: role,
                audience: formData.get('audience'),
                hasContext: !!context,
                stakes: formData.get('stakes'),
                outputType: formData.get('outputType'),
                researchNeeds: formData.get('researchNeeds'),
                verification: formData.get('verification'),
                aiModel: aiModel,
                isMultiModel: aiModel === 'multimodel',
                promptLength: prompt.length,
                delimitersUsed: true,
                timestamp: new Date().toISOString()
            });
            
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        function getAudienceText(audience) {
            const audienceMap = {
                'expert': 'an expert in the field',
                'professional': 'working professionals',
                'student': 'students and learners',
                'general': 'a general audience',
                'executive': 'executives and decision-makers',
                'technical': 'technical specialists'
            };
            return audienceMap[audience] || '';
        }
        
        function getStakesText(stakes) {
            const stakesMap = {
                'high': 'This is critical - I will be making important purchasing/planning decisions based on your research, so accuracy is essential.',
                'medium': 'I need reliable, well-researched information that I can trust.',
                'low': 'This is for general exploration and learning.'
            };
            return stakesMap[stakes] || '';
        }
        
        function getOutputText(outputType) {
            const outputMap = {
                'recommendations': 'Provide specific, actionable recommendations with clear reasoning.',
                'analysis': 'Give me a detailed analysis breaking down the key factors and implications.',
                'comparison': 'Compare and evaluate the different options with pros/cons.',
                'stepbystep': 'Provide a clear step-by-step guide I can follow.',
                'summary': 'Give me a concise but comprehensive overview.',
                'list': 'Organize the information in a clear, structured list format.'
            };
            return outputMap[outputType] || '';
        }
        
        function getResearchText(researchNeeds) {
            const researchMap = {
                'current': 'Search the web for the most current and up-to-date information on this topic.',
                'products': 'Research specific products, including current pricing, availability, and where to purchase. Verify this information is accurate and current.',
                'comprehensive': 'Conduct thorough research using multiple sources to provide a comprehensive analysis.',
                'comparison': 'Research and compare multiple options, products, or services with detailed pros/cons analysis.',
                'verify': 'Verify all claims and statements by searching for reliable sources and current data.',
                'trends': 'Research current trends, recent developments, and emerging patterns in this area.',
                'local': 'Include location-specific information and availability in your research.'
            };
            return researchMap[researchNeeds] || '';
        }
        
        function getVerificationText(verification) {
            const verificationMap = {
                'sources': 'Include reliable sources and citations for your key claims.',
                'doublecheck': 'Cross-reference critical details across multiple reliable sources.',
                'current': 'Prioritize the most recent information available and note when data was last updated.',
                'standard': 'Use your standard research approach with appropriate fact-checking.'
            };
            return verificationMap[verification] || '';
        }
        
        function trackPromptGeneration(data) {
            const analytics = getAnalytics();
            analytics.prompts.push(data);
            analytics.totalPrompts++;
            analytics.lastUpdated = new Date().toISOString();
            localStorage.setItem('promptCrafterAnalytics', JSON.stringify(analytics));
        }
        
        function getAnalytics() {
            const stored = localStorage.getItem('promptCrafterAnalytics');
            if (stored) {
                return JSON.parse(stored);
            }
            return {
                prompts: [],
                totalPrompts: 0,
                lastUpdated: null,
                version: '1.0'
            };
        }
        
        function trackCopy() {
            const analytics = getAnalytics();
            analytics.totalCopies = (analytics.totalCopies || 0) + 1;
            localStorage.setItem('promptCrafterAnalytics', JSON.stringify(analytics));
        }

        function copyToClipboard() {
            const text = document.getElementById('promptOutput').textContent;
            navigator.clipboard.writeText(text).then(function() {
                const copyBtn = document.querySelector('.copy-btn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'Copied!';
                copyBtn.style.background = '#059669';
                
                trackCopy();
                
                setTimeout(function() {
                    copyBtn.textContent = originalText;
                    copyBtn.style.background = '#4f46e5';
                }, 2000);
            });
        }

        function savePrompt() {
            const form = document.getElementById('promptForm');
            const formData = new FormData(form);
            
            const role = formData.get('role') === 'custom' ? formData.get('customRole') : formData.get('role');
            const mainQuery = formData.get('mainQuery');
            
            if (!role || !mainQuery) {
                alert('Please fill in the required fields before saving.');
                return;
            }
            
            const savedPrompt = {
                id: Date.now().toString(),
                title: mainQuery.substring(0, 50) + (mainQuery.length > 50 ? '...' : ''),
                role: role,
                mainQuery: formData.get('mainQuery'),
                context: formData.get('context'),
                stakes: formData.get('stakes'),
                customStakes: formData.get('customStakes'),
                outputType: formData.get('outputType'),
                customOutput: formData.get('customOutput'),
                researchNeeds: formData.get('researchNeeds'),
                customResearch: formData.get('customResearch'),
                verification: formData.get('verification'),
                customVerification: formData.get('customVerification'),
                aiModel: formData.get('aiModel'),
                modelWorkflow: formData.get('modelWorkflow'),
                createdAt: new Date().toISOString(),
                lastUsed: new Date().toISOString()
            };
            
            // Save to local storage
            const savedPrompts = getSavedPrompts();
            savedPrompts.push(savedPrompt);
            localStorage.setItem('promptCrafterSaved', JSON.stringify(savedPrompts));
            
            // Save to Firestore if user is authenticated
            if (currentUser) {
                savePromptToFirestore(savedPrompt);
            }
            
            const analytics = getAnalytics();
            analytics.totalSaves = (analytics.totalSaves || 0) + 1;
            localStorage.setItem('promptCrafterAnalytics', JSON.stringify(analytics));
            
            displaySavedPrompts();
            alert('Prompt saved successfully!');
        }
        
        async function savePromptToFirestore(promptData) {
            if (!currentUser) return;
            
            try {
                const { doc, setDoc } = window.firestoreFunctions;
                const promptRef = doc(window.firebaseDb, 'users', currentUser.uid, 'savedPrompts', promptData.id);
                await setDoc(promptRef, promptData);
                console.log('Prompt saved to Firestore');
            } catch (error) {
                console.error('Error saving to Firestore:', error);
            }
        }
        
        function getSavedPrompts() {
            const saved = localStorage.getItem('promptCrafterSaved');
            return saved ? JSON.parse(saved) : [];
        }
        
        function displaySavedPrompts() {
            const savedPrompts = getSavedPrompts();
            const container = document.getElementById('savedPromptsList');
            
            if (savedPrompts.length === 0) {
                container.innerHTML = '<p style="color: #6b7280; font-style: italic; text-align: center; padding: 20px;">No saved prompts yet. Save your first prompt to get started!</p>';
                return;
            }
            
            const sortedPrompts = savedPrompts.sort(function(a, b) {
                return new Date(b.lastUsed) - new Date(a.lastUsed);
            });
            
            container.innerHTML = sortedPrompts.map(function(prompt) {
                return '<div class="saved-prompt-item">' +
                    '<div class="saved-prompt-info">' +
                        '<div class="saved-prompt-title">' + prompt.title + '</div>' +
                        '<div class="saved-prompt-meta">' +
                            prompt.role + ' ‚Ä¢ ' + new Date(prompt.createdAt).toLocaleDateString() + ' ‚Ä¢ ' + (prompt.aiModel === 'multimodel' ? 'Multi-Model' : 'Claude') +
                        '</div>' +
                    '</div>' +
                    '<div class="saved-prompt-actions">' +
                        '<button class="load-btn" onclick="loadSavedPrompt(\'' + prompt.id + '\')">Load</button>' +
                        '<button class="delete-btn" onclick="deleteSavedPrompt(\'' + prompt.id + '\')">Delete</button>' +
                    '</div>' +
                '</div>';
            }).join('');
        }
        
        function loadSavedPrompt(id) {
            const savedPrompts = getSavedPrompts();
            const prompt = savedPrompts.find(function(p) { return p.id === id; });
            
            if (!prompt) return;
            
            document.querySelectorAll('.template-card').forEach(function(card) {
                card.classList.remove('template-active');
            });
            
            document.getElementById('role').value = prompt.role === prompt.customRole ? 'custom' : prompt.role;
            document.getElementById('customRole').value = prompt.customRole || '';
            document.getElementById('mainQuery').value = prompt.mainQuery;
            document.getElementById('context').value = prompt.context || '';
            document.getElementById('stakes').value = prompt.stakes || '';
            document.getElementById('customStakes').value = prompt.customStakes || '';
            document.getElementById('outputType').value = prompt.outputType || '';
            document.getElementById('customOutput').value = prompt.customOutput || '';
            document.getElementById('researchNeeds').value = prompt.researchNeeds || '';
            document.getElementById('customResearch').value = prompt.customResearch || '';
            document.getElementById('verification').value = prompt.verification || '';
            document.getElementById('customVerification').value = prompt.customVerification || '';
            document.getElementById('aiModel').value = prompt.aiModel || 'claude';
            document.getElementById('modelWorkflow').value = prompt.modelWorkflow || '';
            
            document.getElementById('customRoleGroup').style.display = prompt.role === 'custom' ? 'block' : 'none';
            document.getElementById('customStakesGroup').style.display = prompt.stakes === 'custom' ? 'block' : 'none';
            document.getElementById('customOutputGroup').style.display = prompt.outputType === 'custom' ? 'block' : 'none';
            document.getElementById('customResearchGroup').style.display = prompt.researchNeeds === 'custom' ? 'block' : 'none';
            document.getElementById('customVerificationGroup').style.display = prompt.verification === 'custom' ? 'block' : 'none';
            document.getElementById('modelWorkflowGroup').style.display = prompt.aiModel === 'multimodel' ? 'block' : 'none';
            
            prompt.lastUsed = new Date().toISOString();
            const allSavedPrompts = getSavedPrompts();
            const index = allSavedPrompts.findIndex(function(p) { return p.id === id; });
            allSavedPrompts[index] = prompt;
            localStorage.setItem('promptCrafterSaved', JSON.stringify(allSavedPrompts));
            
            document.getElementById('promptForm').scrollIntoView({ behavior: 'smooth' });
        }
        
        function deleteSavedPrompt(id) {
            if (!confirm('Are you sure you want to delete this saved prompt?')) return;
            
            const allPrompts = getSavedPrompts();
            const filtered = allPrompts.filter(function(p) { return p.id !== id; });
            localStorage.setItem('promptCrafterSaved', JSON.stringify(filtered));
            displaySavedPrompts();
        }
        
        function sharePrompt() {
            const form = document.getElementById('promptForm');
            const formData = new FormData(form);
            
            const shareData = {
                role: formData.get('role') === 'custom' ? formData.get('customRole') : formData.get('role'),
                mainQuery: formData.get('mainQuery'),
                context: formData.get('context'),
                stakes: formData.get('stakes') === 'custom' ? formData.get('customStakes') : formData.get('stakes'),
                outputType: formData.get('outputType') === 'custom' ? formData.get('customOutput') : formData.get('outputType'),
                researchNeeds: formData.get('researchNeeds') === 'custom' ? formData.get('customResearch') : formData.get('researchNeeds'),
                verification: formData.get('verification') === 'custom' ? formData.get('customVerification') : formData.get('verification'),
                aiModel: formData.get('aiModel'),
                modelWorkflow: formData.get('modelWorkflow')
            };
            
            const encodedData = btoa(JSON.stringify(shareData));
            const shareUrl = window.location.origin + window.location.pathname + '?share=' + encodedData;
            
            navigator.clipboard.writeText(shareUrl).then(function() {
                alert('Share link copied to clipboard!');
            });
        }
        
        function loadTemplate(templateId) {
            const template = templates[templateId];
            if (!template) return;
            
            document.querySelectorAll('.template-card').forEach(function(card) {
                card.classList.remove('template-active');
            });
            
            event.target.closest('.template-card').classList.add('template-active');
            
            document.getElementById('role').value = template.role;
            document.getElementById('mainQuery').value = template.mainQuery;
            document.getElementById('context').value = template.context;
            document.getElementById('stakes').value = template.stakes;
            document.getElementById('outputType').value = template.outputType;
            document.getElementById('researchNeeds').value = template.researchNeeds;
            document.getElementById('verification').value = template.verification;
            document.getElementById('aiModel').value = template.aiModel || 'claude';
            
            const workflowGroup = document.getElementById('modelWorkflowGroup');
            if (template.aiModel === 'multimodel' && template.modelWorkflow) {
                document.getElementById('modelWorkflow').value = template.modelWorkflow;
                workflowGroup.style.display = 'block';
            } else {
                workflowGroup.style.display = 'none';
            }
            
            const analytics = getAnalytics();
            analytics.templatesUsed = analytics.templatesUsed || {};
            analytics.templatesUsed[templateId] = (analytics.templatesUsed[templateId] || 0) + 1;
            localStorage.setItem('promptCrafterAnalytics', JSON.stringify(analytics));
            
            document.getElementById('promptForm').scrollIntoView({ behavior: 'smooth' });
        }
        
        function clearForm() {
            document.getElementById('promptForm').reset();
            document.getElementById('outputSection').style.display = 'none';
            document.getElementById('customRoleGroup').style.display = 'none';
            document.getElementById('customStakesGroup').style.display = 'none';
            document.getElementById('customOutputGroup').style.display = 'none';
            document.getElementById('customResearchGroup').style.display = 'none';
            document.getElementById('customVerificationGroup').style.display = 'none';
            document.getElementById('modelWorkflowGroup').style.display = 'none';
            
            const existingError = document.querySelector('.error-message');
            if (existingError) {
                existingError.remove();
            }
        }
        
        function loadSharedPrompt() {
            const urlParams = new URLSearchParams(window.location.search);
            const shareData = urlParams.get('share');
            
            if (shareData) {
                try {
                    const decodedData = JSON.parse(atob(shareData));
                    
                    document.getElementById('role').value = decodedData.role || '';
                    document.getElementById('mainQuery').value = decodedData.mainQuery || '';
                    document.getElementById('context').value = decodedData.context || '';
                    document.getElementById('stakes').value = decodedData.stakes || '';
                    document.getElementById('outputType').value = decodedData.outputType || '';
                    document.getElementById('researchNeeds').value = decodedData.researchNeeds || '';
                    document.getElementById('verification').value = decodedData.verification || '';
                    document.getElementById('aiModel').value = decodedData.aiModel || 'claude';
                    document.getElementById('modelWorkflow').value = decodedData.modelWorkflow || '';
                    
                    document.getElementById('modelWorkflowGroup').style.display = 
                        decodedData.aiModel === 'multimodel' ? 'block' : 'none';
                    
                    alert('Shared prompt loaded successfully!');
                    
                } catch (e) {
                    console.error('Error loading shared prompt:', e);
                }
            }
        }
        
        window.addEventListener('DOMContentLoaded', function() {
            displaySavedPrompts();
            loadSharedPrompt();
        });
        
        function showAbout() {
            alert(`Quill (Beta) - Evidence-Based Prompt Optimization v1.1

What It Is:
A research-driven tool that optimizes AI prompts using validated academic and industry best practices. Built by Dradis Holdings LLC.

How It Works:
1. Select from research-optimized templates
2. Fill in details using our evidence-based form structure
3. Generate prompts optimized with proven techniques (affirmative language, clear delimiters, proper role assignment)
4. Get better AI results through data-driven optimization
5. Save and sync prompts across devices with cloud storage

Current Features:
- 12+ evidence-based prompt templates
- Real-time optimization suggestions (affirmative language detection)
- Automatic research-backed formatting (delimiter insertion)
- Multi-model workflow planning capabilities
- GDPR-compliant cloud sync and data management
- Cross-device access with Google authentication

Beta Research Program:
This beta version implements validated prompt engineering principles from academic research and industry studies. Our optimization approach is based on evidence rather than assumptions, continuously refined through user feedback and ongoing research.

Future Vision:
Upcoming releases will incorporate AI-powered prompt refinement, allowing automated optimization using our research-validated methodology.

¬© 2025 Dradis Holdings LLC`);
        }
    </script>
</body>
</html>
